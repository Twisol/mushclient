<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE muclient>
<!-- Saved on Thursday, August 29, 2002, 2:24 PM -->
<!-- MuClient version 3.27 -->

<!-- Plugin "Get_Last_Sent" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Get_Last_Sent"
   author="Nick Gammon"
   id="cc8f68e16cd7e75c96c59619"
   language="VBscript"
   purpose="Recalls the last thing sent to the MUD"
   date_written="2002-08-29 14:22:05"
   requires="3.25"
   version="1.0"
   >
<description trim="y">
<![CDATA[
This is for recalling the last thing sent to the MUD (even if from a script).

Usage
-----

GLS  <-- gets last thing sent (into the command window)

Get_Last_Sent:help  <-- this help
]]>
</description>

</plugin>


<!--  Aliases  -->

<aliases>
  <alias
   script="GetLastSent"
   match="GLS"
   enabled="y"
  >
  </alias>
</aliases>

<!--  Script  -->


<script>
<![CDATA[
dim LastSent

'
'  remember last thing sent to MUD
'
Function OnPluginSend (sText)
  LastSent = sText ' remember last thing sent
  world.note "lastsent = " & LastSent
  OnPluginSend = vbTrue  ' process it
 End Function

'
'  retrieve last thing sent
'
sub GetLastSent (name, output, wildcards)
dim a, b
  world.note "lastsent = " & LastSent
  a = world.pushcommand
  world.note "a = " & a
  world.setcommand LastSent
  b = world.pushcommand
  world.note "b = " & b
end sub

]]>
</script>


<!--  Plugin help  -->

<aliases>
  <alias
   script="OnHelp"
   match="Get_Last_Sent:help"
   enabled="y"
  >
  </alias>
</aliases>

<script>
<![CDATA[
Sub OnHelp (sName, sLine, wildcards)
  World.Note World.GetPluginInfo (World.GetPluginID, 3)
End Sub
]]>
</script> 

</muclient>
